<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å Google Sheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; padding: 10px; background: #f9f9f9; }
    input, button {
      padding: 10px; margin: 5px 0; width: 100%;
      font-size: 16px; box-sizing: border-box;
    }
    button {
      background-color: #4CAF50; color: white; border: none;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; }
    th, td {
      border: 1px solid #ccc; padding: 8px; text-align: left;
    }
    th.hidden, td.hidden { display: none; }
    th { background-color: #eee; }
    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr { display: block; }
      thead tr { display: none; }
      td {
        position: relative; padding-left: 50%;
        text-align: right; border: none;
      }
      td::before {
        content: attr(data-label);
        position: absolute; left: 10px; top: 8px; font-weight: bold; text-align: left;
      }
    }
  </style>
</head>
<body>
  <h2>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥</h2>
  <input type="text" id="searchInput" placeholder="üîç ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤">
  <button onclick="filterTable()">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
  <table id="dataTable">
    <thead id="tableHead"></thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>
    let data = [], headers = [];

    async function fetchCSV() {
      const response = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vReK1auMBXGO9QIj41JHCk6iV5UTfhFeO7_-7xbgy6yek2-k087jFwXusi8X0BJOi1TE2b_tHXDmine/pub?output=csv");
      const text = await response.text();
      const lines = text.split('\\n').filter(l => l.trim());
      headers = lines[0].split(',');
      data = lines.slice(1).map(l => l.split(','));
      data = removeDuplicates(data); // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥
      renderTable(data);
    }

    function removeDuplicates(arr) {
      const seen = new Set();
      return arr.filter(row => {
        const key = row.slice(1).join('|'); // ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° column A
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });
    }

    function renderTable(rows) {
      const thead = document.getElementById("tableHead");
      const tbody = document.getElementById("tableBody");
      thead.innerHTML = ""; tbody.innerHTML = "";

      const headerRow = document.createElement("tr");
      headers.forEach((h, i) => {
        const th = document.createElement("th");
        if (i === 0) th.classList.add("hidden");
        th.textContent = h;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      rows.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach((cell, i) => {
          const td = document.createElement("td");
          if (i === 0) td.classList.add("hidden");
          td.setAttribute("data-label", headers[i]);
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    function filterTable() {
      const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
      const filtered = data.filter(row =>
        row.slice(1).some(cell => cell.toLowerCase().includes(keyword))
      );
      renderTable(filtered);
    }

    document.getElementById("searchInput").addEventListener("keypress", function(e) {
      if (e.key === "Enter") filterTable();
    });

    fetchCSV();
  </script>
</body>
</html>
